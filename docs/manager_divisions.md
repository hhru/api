# Отделы менеджера

Менеджер может выполнять действия от лица нескольких отделов. Для взаимодействия с API в контексте определенного
отдела работодателя нужно использовать соответсвующий отдел.
У пользователя может быть несколько отделов, один из них является текущим. Какой отдел является текущим можно узнать,
получив [список отделов менеджера](#get-manager-divisions). Текущий отдела используется, если в качестве авторизации посылать только токен
(подробнее можно прочитать [здесь](#using-division)).

* [Получение списка отделов пользователя](#get-manager-divisions)
* [Выбор отдела при запросах](#using-division)

<a name="get-manager-divisions"></a>
## Получение списка отделов пользователя

### Запрос

```
GET /manager_divisions/mine
```

### Ответ

Успешный ответ приходит с кодом `200 OK` и содержит тело:

```json
{
    "found": 2,
    "page": 0,
    "pages": 1,
    "per_page": 2,
    "items": [
        {
            "id": "1",
            "name": "Департамент персонала"
        },
        {
            "id": "2",
            "name": "Департамент продаж"
        }
    ],
    "current_division_id": "2"
}
```

где:

Имя | Тип | Описание
--- | --- | ------
items | список | список отделов менеджера
current_division_id | строка | идентификатор текущего отдела (совпадает со значением переданного в заголовке)

<a name="division-info"></a>
#### Объект `division`

Имя | Тип | Описание
--- | --- | ------
id | строка | идентификатор отдела
name | строка | название отдела компании

### Ошибки

* `403 Forbidden` — ошибка авторизации (пользователь не является менеджером)
* `404 Not Found` — нет отделов у менеджера


<a name="using-division"></a>
## Выбор отдела при запросах

Для работы под определенным отделом необходимо передать значение `division_id`, полученное из [списка](#get-manager-divisions), в заголовке:

```
X-Manager-Division-Id: {division_id}
```

Использовать данный заголовок можно во всех методах, доступных для работодателей.

В заголовке можно передавать `division_id` текущего отдела, который также подразумевается по умолчанию, при отсутсвии заголовка.


<a name="errors"></a>
## Ошибки

* `403 Forbidden` — ошибка авторизации (при запросах с авторизацией не работодателя)
* `404 Not Found` — отдел с переданным `division_id` не найден
* [Дополнительные ошибки с описанием причины](/docs/errors.md#manager-divisions).
