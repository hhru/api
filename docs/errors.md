# Ошибки и коды ответов

API широко использует информирование при помощи HTTP кодов ответов. Приложение
должно корректно их обрабатывать.

При каждой ошибке, помимо кода ответа, в теле ответа выдаётся
дополнительная информация, позволяющая разработчику понять 
причину ошибки.

Все ошибки выдаются в формате:

```json
{
    "errors": [
        {
            "type": "...",
            "value": "..."
        }
    ]
}
```

Одновременно может выдаваться несколько ошибок.
Ключ `type` присутствует в каждом объекте массива `errors` и содержит текстовый
идентификатор класса ошибки. Ключ `value` опционален и конкретизирует данные
об ошибке.

> Помимо описанных выше `errors`, API может выдавать дополнительно другие ключи,
> оставленные для обратной совместимости. **Использовать их не рекомендуется.**


<a name="general-errors"></a>
## Ошибка в запросе

В случае невозможности найти запрашиваемый ресурс вернётся ответ
`404 Not Found` и в массиве `errors` будет объект:

```json
{
    "type": "not_found"
}
```

При ошибке в параметрах запроса (к примеру,
`GET https://api.hh.ru/vacancies/?employer_id=foo`) в ответ придёт
`400 Bad Request`, в массиве ошибок будет объект:

```json
{
    "type": "bad_argument",
    "value": "employer_id"
}
```

<a name="system-errors"></a>
## Системная ошибка

Если в данный момент сервис не может обработать запрос, но он его корректно
понял, то в ответ придёт `503 Service Unavailable` и `type` будет содержать
`service_unavailable`.

В случае непредвиденной ситуации API вернёт 500.

В редких случаях ошибки с 5** кодами могут возвращаться с телом не содержащим
валидный json. Приложение должно в таких случаях ориентироваться только на код
ответа.


## Общие ошибки запроса

<a name="user-agent"></a>
### Неверный User-Agent

Подробнее про [заголовок User-Agent](general.md#request-requirements).

HTTP code | type | value | описание
----------|------|-------|-----------
400 | bad_user_agent | unset | заголовок User-Agent не передан
400 | bad_user_agent | blacklisted | значение User-Agent в чёрном списке


## Ошибки авторизации

Подробнее [про авторизацию](authorization.md).


<a name="oauth"></a>
### Ошибки использования авторизации

В случае, если вы
[совершаете авторизованный запрос](authorization.md#check-access_token)
в api и предоставленная авторизация по каким-либо причинам не действительна,
вернётся ошибка с `type` `oauth` и, возможно, одним из перечисленных `value`.

HTTP code | type | value | описание
----------|------|-------|-----------
403 | oauth | bad_authorization | токен авторизации не существует или не валидный
403 | oauth | token_expired | время жизни access_token завершилось, необходимо [выполнить обновление access_token](authorization.md#refresh_token)
403 | oauth | token_revoked | токен отозван пользователем, приложению необходимо [запросить новую авторизацию](authorization.md)
403 | oauth | application_not_found | ваше приложение было удалено


<a name="service-errors"></a>
## Ошибки отдельных ресурсов

В тех случаях, когда сервис способен выдать более подробную информацию об
ошибке, она будет выдана в теле ответа. В этом случае скорее всего
код ответа будет 400, 403, 409, 429, но возможны и другие.

Как минимум, приложение должно корректно обрабатывать HTTP статусы ответов.
Для более удобной работы с приложением, рекомендуется также обрабатывать
пришедший тип ответа. Приведенные ниже таблицы содержат неполный список ошибок,
он может расширяться.


<a name="artifacts"></a>
### Артефакты

При загрузке артефактов помимо прочих возможны следующие ошибки:

HTTP code | type | value | описание
----------|-----|--------|-----------
400 | bad_argument | file | не указан файл, либо указано несколько
400 | bad_argument | type | некорректное значение параметра type
400 | bad_argument | description | слишком длинное описание
400 | artifacts | limit_exceeded | превышено количество артефактов
400 | artifacts | image_too_large | размер файла больше допустимого
400 | artifacts | unknown_format | неизвестный формат файла
403 | forbidden | — | ошибка прав доступа


<a name="negotiations"></a>
### Переписка (отклики/приглашения)

Помимо [общих ошибок](#general-errors), могут быть возвращены следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|-----------
400 | negotiations | vacancy_not_found | вакансия не найдена
403 | negotiations | invalid_vacancy | вакансия из отклика/приглашения была архивирована либо скрыта
400 / 403 | negotiations | resume_not_found | резюме из отклика/приглашения было скрыто, либо удалено, либо не найдено
403 | negotiations | already_applied | уже есть отклик/приглашение на указанную связку resume_id+vacancy_id
403 | negotiations | test_required | для отклика необходимо пройти тест (в данный момент, отклик на такие вакансии через API недоступен)
403 | negotiations | resume_visibility_conflict | невозможно откликнуться на анонимную вакансию резюме с видимостью "белый список"
403 | negotiations | edit_forbidden | редактирование сообщения недоступно
403 | negotiations | application_denied | общая ошибка запрета отклика в случае, когда дополнительная информация недоступна
400 / 403 | negotiations | limit_exceeded | превышен лимит количества откликов/приглашений
403 | negotiations | wrong_state | действие по отклику/приглашению в данном статусе невозможно
403 | negotiations | empty_message | передан пустой текст письма
403 | negotiations | too_long_message | передан слишком длинный текст письма
403 | negotiations | address_not_found | переданный к действию по адрес не существует, либо принадлежит другому работодателю
403 | negotiations | not_enough_purchased_services | не хватает оплаченных услуг, обычно [доступа к базе резюме](https://hh.ru/price#dbaccess)
403 | negotiations | in_a_row_limit | превышено количество последовательных сообщений в переписке, оппонент должен ответить на сообщение, чтобы появилась возможность писать вновь
403 | negotiations | overall_limit | превышен лимит сообщений
403 | negotiations | no_invitation | переписка недоступна, так как в отклике ещё не было приглашения
403 | negotiations | message_cannot_be_empty | сообщение в переписке не может быть пустым
403 | negotiations | disabled_by_employer | возможность переписки по отклику отключена работодателем
403 | negotiations | resume_deleted | отправить сообщение невозможно, так как резюме, с которым совершался отклик, удалено или скрыто
403 | negotiations | archived | отправить сообщение невозможно, так как вакансия, на которую совершался отклик, заархивирована



<a name="vacancies_favorited"></a>
### Отобранные вакансии

Помимо кода ошибки при
[добавлении в список отобранных вакансий](vacancies.md#favorited) могут
быть возвращены следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|-----------
403 | vacancies_favorited | vacancy_archived | вакансия уже архивирована и не может быть добавлена в отобранное
403 | vacancies_favorited | limit_exceeded | превышен лимит количества отобранных вакансий


<a name="vacancies-create-n-edit"></a>
### Публикация и редактирование вакансий

Помимо кода ошибки при [публикации](employer_vacancies.md#creation) и
[редактировании](employer_vacancies.md#edit) вакансии могут быть возвращены
следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|---------
400 | vacancies | *field_name* | ошибка в поле вакансии, где *field_name* – ключ поля верхнего уровня
403 | vacancies | not_enough_purchased_services | купленных услуг для публикации или обновления данного типа вакансии не достаточно
403 | vacancies | quota_exceeded | квота менеджера на публикацию данного типа вакансии закончилась
403 | vacancies | duplicate | аналогичная вакансия уже опубликована, данную ошибку можно [форсировано отключить](employer_vacancies.md#creation-ignore-duplicates)
403 | vacancies | creation_forbidden | публикация вакансий недоступна текущему менеджеру
403 | vacancies | unavailable_for_archived | редактирование недоступно для архивной вакансии
403 | vacancies | conflict_changes | конфликтные изменения данных вакансии ([подробнее](employer_vacancies.md#edit_more))
403 | vacancies | can_not_accept_kids | публикация вакансий для поиска соискателей от 14 лет недоступна ([подробнее](employer_vacancies_accept_kids.md#accept-kids))


<a name="vacancies-prolongate"></a>
### Продление вакансии

Помимо кода ошибки при [продлении](employer_vacancies.md#prolongate) вакансии могут быть
возвращены следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|---------
403 | vacancies | not_enough_purchased_services | купленных услуг для продления данного типа вакансии не достаточно
403 | vacancies | quota_exceeded | квота менеджера на публикацию данного типа вакансии закончилась
403 | vacancies | prolongation_forbidden | продление вакансий недоступно текущему менеджеру
403 | vacancies | unavailable_for_archived | продление недоступно для архивной вакансии
403 | vacancies | too_early | продление раньше времени


<a name="employer_managers"></a>
### Менеджеры работодателя

Помимо [общих ошибок](#general-errors) при [добавлении](employer_managers.md#add) и
[редактировании](employer_managers.md#edit) менеджера работодателя могут быть возвращены следующие ошибки:

HTTP code | type | value | reason | описание
----------|------|-------|--------|---------
400 | managers | *field_name* | | ошибка в поле *field_name*
403 | managers | email | already_exist | менеджер с такой почтой уже существует
403 | managers |  | creation_limit_exceeded | достигнут лимит на создание менеджеров
403 | managers | *field_name* | not_editable | поле *field_name* недоступно для редактирования


<a name="resumes"></a>
### Работа с резюме

Помимо [общих ошибок](#general-errors) при
[получении](resumes.md#item) и [обновлении](resumes.md#create_edit) резюме могут
быть возвращены следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|---------
400 | resumes | total_limit_exceeded | превышено допустимое количество резюме (актуально только для соискателей)
429 | resumes | view_limit_exceeded | превышен лимит просмотров резюме в сутки (актуально только для работодателей)


<a name="vacancies_blacklist"></a>
### Добавление в список скрытых вакансий

Помимо [общих ошибок](#general-errors) при
[добавлении в список скрытых вакансий](blacklisted.md#vacancies)
могут быть возвращены следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|---------
400 | vacancies_blacklist | limit_exceeded | превышен лимит на количество вакансий в списке скрытых
404 | vacancies_blacklist | not_found | вакансия для добавления в список не найдена


<a name="employers_blacklist"></a>
### Добавление в список скрытых компаний

Помимо [общих ошибок](#general-errors) при
[добавлении в список скрытых вакансий компаний](blacklisted.md#employers)
могут быть возвращены следующие ошибки:

HTTP code | type | value | описание
----------|------|-------|---------
400 | employers_blacklist | limit_exceeded | превышен лимит на количество вакансий в списке скрытых
404 | employers_blacklist | not_found | вакансия для добавления в список не найдена


<a name="resume-visibility-lists"></a>
### Списки видимости резюме

<a name="resume-visibility-lists-get"></a>
#### Получение списков видимости

HTTP code | type | value | описание
----------|------|-------|---------
400 | bad_argument | per_page | передано невалидное количество элементов на странице (максимум 100)

<a name="resume-visibility-lists-add"></a>
#### Добавление компаний в список

HTTP code | type | value | описание
----------|------|-------|---------
400 | resume_visibility_list | unknown_employer | передан неизвестный идентификатор работодателя
400 | resume_visibility_list | limit_exceeded | превышен лимит списка видимости
400 | resume_visibility_list | too_many_employers | передано слишком много работодателей

<a name="resume-visibility-lists-remove"></a>
#### Удаление компаний из списка

HTTP code | type | value | описание
----------|------|-------|---------
400 | bad_argument | id | передан невалидный идентификатор работодателя
400 | resume_visibility_list | too_many_employers | передано слишком много работодателей
